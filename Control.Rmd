---
title: "Control data analysis workbook"
output: html_notebook
---

# Database creation chunks
## Create an MS1 database for AsHC, AsFA, AsSugPL, lysoAsSugPL, AsPC (single and double charges are different righ tnow) and a few extras, split it up into smaller and larger masses to use for the inclusion list
```{r, warning=FALSE, message = FALSE}
source("SourceCode/database_construction.R")
```

https://www.bioconductor.org/packages/devel/bioc/vignettes/CluMSID/inst/doc/CluMSID_tutorial.html


# Data analysis chunks
## Tidy up ICAP data
This code takes in combined .csv files from the ICAP (with Y and time), tidies them up a bit and writes out new files and writes them in to the pivoted folder within rawdat
```{r, warning=FALSE, message = FALSE}
source("SourceCode/extract_and_organize_ICAPdata09012020.R") #first run of Aslipids
source("SourceCode/extract_and_organize_ICAPdata201026.R") #second run of Aslipids
```

## Calculate 75As in lipids concentrations
Gets peak areas of As peaks in ICPMS data files
Writes this out into Intermediates/AsLipids_ICPpeakareas.csv
```{r, warning=FALSE, message = FALSE}
# Get area of cobalt standards for RF
source("SourceCode/standard_area_extraction.R")

# Does baseline, peak detection, and smoothing of ICP data, then gets areas of detected peaks, turns those into concentrations
source("SourceCode/get_peak_areas_201026.R") 

# Gets under-the-hump area and concentrations for all samples
source("SourceCode/under_the_hump_areas.R")
```

## Extract and merge MS2 data 
This takes a long time (with retention time window of 20 s).  
Only needs to be run again if we decide to merge differently
```{r, warning=FALSE, message = FALSE}
source("SourceCode/MS2_extractor.R")
```

## Targeted Search, plots MS1, MS1 of C13 (scaled), and MS2 (if it picked)
Saves each sample as a PDF in Intermediates/ 
```{r, warning=FALSE, message = FALSE}
source("SourceCode/targeted_search.R")
```

## Targeted Search based on MS2 only
```{r, warning=FALSE, message = FALSE}
source("SourceCode/targeted_search_MS2work.R")
```

## Put identifications on the peaks to get 
Writes "Intermediates/IDd_Lipids_Quanified.csv"
```{r, warning=FALSE, message = FALSE}
source("SourceCode/identification_of_quantified_peaks.R")
```






#
# Figures
## Standard curve figures
Writes 2 figures into Figures/ManuscriptReady
```{r, warning=FALSE, message = FALSE}
source("Figures/Rcode/Std_curves.R")
```

## Preliminary figure of lipid ICAP chromats
Writes 1 figures into Figures/Preliminary
```{r, warning=FALSE, message = FALSE}
source("Figures/Rcode/Lipid_Exploratory_Plots.R")
```




#
# Tables
## Sample overview
Writes sample overview table into Tables/ManuscriptReady
```{r, warning=FALSE, message = FALSE}
source("Tables/Rcode/Sample_descriptions.R")
```

## Table of bulk concentrations
Working on this as of 10/12/20
```{r, warning=FALSE, message = FALSE}
source("Tables/Rcode/Quantitative_overview.R")
```
#